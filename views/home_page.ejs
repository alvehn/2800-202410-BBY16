<%- include("templates/header") %>
<div class="flex flex-col h-screen relative">
  <div class="flex items-end justify-center bg-gray-200 relative h-2/3 overflow-hidden">
    <!-- Background layers for parallax effect -->
    <div class="static-background-home"></div>
    <!-- animal sprite -->
    <div class="w-[320px] h-[160px] pet z-50 animate-idle" style="background-image: url('/sprite_sheets/<%= user.current_pet_name %>.png')"></div>
  </div>
  <div class="flex flex-col items-center justify-center bg-white p-4 z-20 relative h-1/3">
    <div class="text-4xl font-bold text-gray-700 mb-4">
      <span id="hr">00</span>
      <span class="text-sm">Hr</span>
      <span id="min">00</span>
      <span class="text-sm">Min</span>
      <span id="sec">00</span>
      <span class="text-sm">Sec</span>
    </div>
    <div>
      <% if (user.study_session.inSession) { %>
        <form action="/view_study_session" method="POST">
          <input type="hidden" name="sessionId" value="<%= user.study_session.currentSessionID %>">
          <button type="submit" class="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition">View My Session</button>
        </form>
      <% } else { %>
        <form action="/start_study_session" method="POST">
          <button type="submit" class="px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 transition">Start Study Session</button>
        </form>
      <% } %>
    </div>
  </div>
</div>
<script>
    const hrSpan = document.getElementById('hr');
    const minSpan = document.getElementById('min');
    const secSpan = document.getElementById("sec");
    const duration = <%= user.hours_per_day %>;

    function displayTime(){
      const hours = Math.floor(duration / 3600);
      const minutes = Math.floor((duration % 3600) / 60);
      const seconds = Math.floor(duration % 60);

      hrSpan.textContent = String(hours).padStart(2, '0');
      minSpan.textContent = String(minutes).padStart(2, '0');
      secSpan.textContent = String(seconds).padStart(2, '0');
    }

    displayTime();
</script>
<%- include("templates/navbar") %>
